package com.an.github.ui.adapter

import android.support.v7.widget.RecyclerView
import android.view.LayoutInflater
import android.view.ViewGroup

import com.an.github.databinding.FilterItemBinding

class FilterListAdapter(private val items: List<String>) : RecyclerView.Adapter<FilterListAdapter.CustomViewHolder>() {
    private var lastSelectedPosition = 0

    override fun onCreateViewHolder(parent: ViewGroup, i: Int): CustomViewHolder {
        val layoutInflater = LayoutInflater.from(parent.context)
        val itemBinding = FilterItemBinding.inflate(layoutInflater, parent, false)
        return CustomViewHolder(itemBinding)
    }

    override fun onBindViewHolder(holder: CustomViewHolder, position: Int) {
        val item = getItem(position)
        holder.bindTo(item)
    }

    override fun getItemCount(): Int {
        return items.size
    }

    fun getItem(position: Int): String {
        return items[position]
    }

    fun updateSelection(currentPosition: Int) {
        val previousPosition = lastSelectedPosition
        this.lastSelectedPosition = currentPosition
        notifyItemChanged(previousPosition)
        notifyItemChanged(lastSelectedPosition)
    }

    inner class CustomViewHolder(private val binding: FilterItemBinding) : RecyclerView.ViewHolder(binding.root) {
        init {
            binding.btnRadio.isEnabled = false
        }

        fun bindTo(item: String) {
            binding.btnRadio.text = item
            binding.btnRadio.isChecked = (lastSelectedPosition == layoutPosition)
        }
    }
}
